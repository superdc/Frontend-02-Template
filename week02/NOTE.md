## 学习笔记

### 语言通识

从更宏观的角度看待编程语言，了解到语言的分类，描述编程语言的方式以及编程语言的性质。

编程语言属于上下文无关文法，语言中的特例可能属于上下文相关文法或正则文法。跟 Unicode 字符集的产生背景一样，编程语言也需要通用的方式来描述它的语法，比较流行的就是 BNF 范式。

看到 BNF 范式的形式，让我想起了 CSS 中属性的值的描述方式，这其实也是一种产生式的表示方式吧。

为什么要学习产生式呢？

先看一下程序是如何执行的？经过了哪些步骤？

    源码 -> 词法分析-> 语法分析-> 解释器->执行结果

在语法分析阶段，要分析源代码是否符合语法规则以及如何对表达式/语句进行组合，这部分就要使用到产生式，看是否一个表达式可以用产生式推导出来。

如果要想更深的理解，可能要去学习一下编译原理的知识了。对编程语言性质的理解，要多了解几门性质不同的语言来对比一下，可能效果更好。


### 重学 JS 类型

主要对 Number, String 类型的理解更深一些。

#### Number

对 Number 类型的存储和计算有了新的认识。

Q: 为什么 0.1 + 0.2 === 0.3 返回 false ?

JavaScript 采用 IEEE 754 64 位双精度浮点数存储 Number 类型的值。

64 位包括：

- Sign: 1 位符号位
- Exponent: 11 位指数位。为使指数为正数，取基数 1023
- Fraction: 52 位精度位，超出部分进 1 舍 0。因为第一位为 1， 所以省略，实际可表示 53 位。

0.1 + 0.2 的计算步骤：

- 10 进制转化为 2 进制，因为精度位有限，在转化过程中有精度损失
  0.1 -> 0.0001 1001 1001 1001...
  0.2 -> 0.0011 0011 0011 0011...
- 相加取和，这一步仍然有精度损失

- 得到损失精度的结果

结论：当比较算术运算的结果时，误差小于 Number.EPSILON 就可以认为相等。




#### String

了解了字符集与字符编码之间的关系和区别以及 ES6 中增加相应字符串处理方法的原因。编写了 utf-8 编码的代码，进一步理解了编码原理。

#### 字符集与编码

#### ASCII

American Standard Code for Information Interchange，美国信息交换标准代码。

产生背景：为了字母，数字及常用符号在不同的计算机中可以互相通信和理解，需要一致的二进制表示形式，也就是必须使用相同的编码规则，于是产生了 ASCII 编码来统一规定哪些字符对应哪些二进制表示。

表示方式：7 位或 8 位二进制表示。标准 ASCII 码（或者基础 ASCII 码）使用 7 位二进制表示所有的大写/小写字母，数字，标点符号和美式英语中使用的特殊控制字符等，共 128 个。扩展 ASCII 码使用每个字符的第 8 位来确定附加的 128 个特殊符号字符，外来语字母和图形符号等。

问题：ASCII 表示的字符数有限，对其他语言中字符的表示是不够的。而且不同语言编码方式不统一，不利于通信，于是产生了 Unicode 编码标准。

#### Unicode

可以容纳世界上所有文字和符号的字符编码标准，每个符号都对应一个独一无二的编码。

#### 术语

- Code point，码点。每个符号在 Unicode 字符集中的表示。
  - 范围：U+0000 ~ U+10FFFF
- Plane, 平面。从 U+0000 ~ U+nFFFF(n: 十六进制的 0 到 10) 共 65536 个码点的集合。Unicode 有 17 个平面。
- BMP（Basic Multilingual Plane），U+0000 ~ U+FFFF，也是 Plane 0，4 位 16 进制表示。包括了绝大多数常用的符号。
- Astral Planes (Supplementary planes)，U+10000 ~ U+10FFFF，Plane1 ~ Plane 16，需要 5/6 位二进制表示。
- Code units, 码元。用指定编码方式对 Unicode 符号进行编码得到的二进制序列。

因为 Unicode 只是对符号的抽象表示，但是如何在计算机中进行存储没有规定，所以产生了不同的编码方式，用于将 Unicode code point -> code unit(计算机中的表示)，比较流行的编码方式有：UTF-8, UTF-16, UTF-32。

#### UTF-8 等编码方式

UTF-8, UTF-16, UTF-32 各种编码方式有自己的编码规则，优缺点就是看谁占的空间少。

UTF-8 和 UTF-16 是变长编码，具体编码规则可以看相应规范。

#### JavaScript 与 Unicode

JavaScript 引擎采用 UTF-16（最初是 UCS-2）编码，造成所有字符都是 2 个字节，如果是 4 字节字符，会当做两个双字节字符处理。这一点使所有 JS 的字符函数都受到影响，无法返回正确结果。

比如：

    '😁'.length // 结果是 2 而不是 1

ES6 增强了对 Unicode 的支持。

1. 字符串迭代器可以正确将字符串拆分为代码点
   - for ... of
   - Array.from()
2. string.codePointAt() 可以正确返回代码点，string.charCodeAt() 不能




#### Null & Undefined

1. undefined 是 window 的属性，在 es5 之前可以被修改，在 es5 之后标准才不允许修改 undefined 的值
2. undefined 不是关键字
3. 最好用 void 0 代替 undefined
